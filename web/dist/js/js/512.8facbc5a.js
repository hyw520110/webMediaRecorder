"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[512],{512:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});const n=()=>{let t=2,e=[];function s(s){let n=s.length,i=new Uint8Array(n*t);for(let e=0;e<n;e++){let n=e*t,a=s[e];a>1?a=1:a<-1&&(a=-1),a*=32768,i[n]=a,i[n+1]=a>>8}e.push(i)}function n(s){let n=e.length?e[0].length:0,i=e.length*n,a=new Uint8Array(44+i),r=new DataView(a.buffer);r.setUint32(0,1380533830,!1),r.setUint32(4,36+i,!0),r.setUint32(8,1463899717,!1),r.setUint32(12,1718449184,!1),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,1,!0),r.setUint32(24,s,!0),r.setUint32(28,s*t,!0),r.setUint16(32,t,!0),r.setUint16(34,8*t,!0),r.setUint32(36,1684108385,!1),r.setUint32(40,i,!0);for(let t=0;t<e.length;t++)a.set(e[t],t*n+44);e=[],postMessage(a.buffer,[a.buffer])}onmessage=t=>{"encode"===t.data[0]?s(t.data[1]):"dump"===t.data[0]&&n(t.data[1])}};let i,a=window.AudioContext||window.webkitAudioContext,r=t=>{let e=t.toString().replace(/^(\(\)\s*=>|function\s*\(\))\s*{/,"").replace(/}$/,""),s=new Blob([e]);return new Worker(URL.createObjectURL(s))},o=t=>{let e=new Event("error");return e.data=new Error("Wrong state for "+t),e};class c{constructor(t,e=null){this.stream=t,this.config=e,this.state="inactive",this.em=document.createDocumentFragment(),this.encoder=r(c.encoder);let s=this;this.encoder.addEventListener("message",(t=>{let e=new Event("dataavailable");e.data=new Blob([t.data],{type:s.mimeType}),s.em.dispatchEvent(e),"inactive"===s.state&&s.em.dispatchEvent(new Event("stop"))}))}start(t){if("inactive"!==this.state)return this.em.dispatchEvent(o("start"));this.state="recording",i||(i=new a(this.config)),this.clone=this.stream.clone(),this.input=i.createMediaStreamSource(this.clone),this.processor=i.createScriptProcessor(2048,1,1),this.encoder.postMessage(["init",i.sampleRate]),this.processor.onaudioprocess=t=>{"recording"===this.state&&this.encoder.postMessage(["encode",t.inputBuffer.getChannelData(0)])},this.input.connect(this.processor),this.processor.connect(i.destination),this.em.dispatchEvent(new Event("start")),t&&(this.slicing=setInterval((()=>{"recording"===this.state&&this.requestData()}),t))}stop(){return"inactive"===this.state?this.em.dispatchEvent(o("stop")):(this.requestData(),this.state="inactive",this.clone.getTracks().forEach((t=>{t.stop()})),this.processor.disconnect(),this.input.disconnect(),clearInterval(this.slicing))}pause(){return"recording"!==this.state?this.em.dispatchEvent(o("pause")):(this.state="paused",this.em.dispatchEvent(new Event("pause")))}resume(){return"paused"!==this.state?this.em.dispatchEvent(o("resume")):(this.state="recording",this.em.dispatchEvent(new Event("resume")))}requestData(){return"inactive"===this.state?this.em.dispatchEvent(o("requestData")):this.encoder.postMessage(["dump",i.sampleRate])}addEventListener(...t){this.em.addEventListener(...t)}removeEventListener(...t){this.em.removeEventListener(...t)}dispatchEvent(...t){this.em.dispatchEvent(...t)}}c.prototype.mimeType="audio/wav",c.isTypeSupported=t=>c.prototype.mimeType===t,c.notSupported=!navigator.mediaDevices||!a,c.encoder=n;const h=c}}]);
//# sourceMappingURL=512.8facbc5a.js.map